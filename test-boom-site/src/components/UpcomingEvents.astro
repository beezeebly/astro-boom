---
import { getCollection } from 'astro:content';

const events = await getCollection('events');
const upcomingEvents = events
  .filter(event => event.data.start > new Date())
  .sort((a, b) => a.data.start.getTime() - b.data.start.getTime())
  .slice(0, 3);
---

<div>
  <h2 class="text-2xl font-bold mb-6">Upcoming Events</h2>
  {upcomingEvents.length > 0 ? (
    <div class="space-y-4">
      {upcomingEvents.map((event) => (
        <div class="bg-gray-50 p-4 rounded-lg">
          <h3 class="font-semibold text-lg">
            <a href={'/events/' + event.slug} class="hover:text-primary">
              {event.data.title}
            </a>
          </h3>
          <p class="text-sm text-gray-600">
            {event.data.start.toLocaleDateString()} at {event.data.start.toLocaleTimeString()}
          </p>
          {event.data.location && (
            <p class="text-sm text-gray-500">ğŸ“ {event.data.location}</p>
          )}
          <p class="text-gray-600 mt-2">{event.data.description}</p>
        </div>
      ))}
    </div>
  ) : (
    <p class="text-gray-600">No upcoming events scheduled.</p>
  )}
</div>